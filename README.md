### Метода оптмизации

Привет. Предлагаю сегодня разобраться с некоторыми математическими методами оптимизации. Их довольно много, но не так сложно.
Посмотрим, что у нас есть:
- Метод Ньютона
- Метод серединной точки
- Метод отрезка по полам
- Метод хорд
- Метод квадратичной аппроксимации
- Симплекс-метод.

  ![](https://media.tenor.com/CmXfEyPv4eMAAAAM/ого-ogo.gif)
  
Любая задача по методам оптимизации сводится к поиску минимума или максимума на отрезке [a;b]. И так же мы задаем некую точность, с которой мы будем находить решение. Это символ эпсила, но тут я буду помечать его как `e` 
Ну поехали.
# Метод отрезка по полам

Данный метод несложный и интуитивно понятный. У нас дан отрезок, точность `e` и функция f(x).
Мы берем две точки на графике, которые близки к середине. Одна точка слева от середины, другая — справа. Вычисляются так: $x_1 = (a+b-e)/2$ и $x_2 = (a+b+e)/2$. 
Дальше в этих двух точках вычисляются значения функций $f(x_1)$ и $f(x_2)$. И если первая больше второй, то граница a сдвигается на $x_1 (a = x_1)$. В противном случае двигаем границу b. И так мы делаем, пока расстояние между a и b больше $2*e$.
Как только условие остановки выполнилось, то находим середину $x = (a+b)/2$ и это наш результат.

Ну что, вроде пока не так сложно. Продолжим.

# Метод золотого сечения

Если предыдущая задача сводится к делению отрезка пополам, то здесь к делению золотым сечением. То есть надо разделить отрезок так, чтобы отношение большой части ко всему отрезку была равно отношению меньшей части к большей.
И обычно длина меньшей части составляет примерно: меньшая часть = 0.382 от всей длины, а большая = 0.618. То есть первая точка $x_1 = a + 0.382*(b-a), x_2 = a + 0.618(b-a)$. И дальше вычисляем функции в этих точках.
Если $f(x_1) < f(x_2)$, то мы границу b сдвигаем к $x_2$, $x_2 = x_1$, а $x_1 = a + 0.382(x_2 - a)$, иначе границу a — к $x_1$, $x_1 = x_2$, а $x_2 = a + 0.618(b - x_1)$. Условие остановки: $b - a < e$.

# Метод Фибоначчи

Короче, всё то же самое, но только вместо 0,382 и 0,618 мы ставим $F_t / F_m$, где $t = n - k, m = n + 1 - k$, и ставим $F_c / F_m$, где $c = n - 1 - k$. То есть у нас $x_1 = a + F_t / F_m * (b - a), x_2 = a + F_c / F_m * (b-a)$.

А $F_n$ — это n-е число Фибоначчи. И поскольку там есть некая закономерность, то решили, что можно вывести формулу для каждого числа.

$F_n = 1 / \sqrt{5} * [(1 + \sqrt{5})^2 / 2 - (1 - \sqrt{5})^2 / 2]$

Дальше всё как в методе золотого сечения: на каждой итерации вычисления функции происходят в одной точки, в зависимости от сравнения вычисленных функций в $x_1$ и $x_2$. Условия сдвига границ и остановки те же.

# Метод серединной точки

Этот метод чем-то похож на метод деления отрезка пополам. Но если в том методе мы находили точки по обе стороны от середины, то здесь мы берем четко середину. А условие остановки: когда производная функции в этой середине будет меньше заданной точности.

То есть мы имеем $x_k = (a_k - b_k)/2$ и если $f'(x_k) = 0$ или $<= e$, то наш результат — тот $x$, что мы вычислили. А иначе, если производная меньше 0, то $a_n = x_k, b_n = b_k$, где $n = k+1$, иначе наоборот: $a_n = a_k, b_n = x_k$.

# Метод хорд

Пусть $y(x_k)$ — это производная функции от $x_k$.

Данный метод сводится к построению графика производной функции и построению на нем хорды. И точка пересечения с осью x — $x_h$. Мы находим ее на графике и находим на ней значение производной функции. И дальше отрезок $[a; x_h]$ или $[x_h; b]$ выбирается так же, как и в предыдущем методе.

А вообще идея в том, что минимум у нас в том $x$, при котором производная функции равна нулю. 

Собственно, как вычисляется наша $x_h$:

$x_h = a - y(a)/(y(a) - y(b)) * (a-b)$

![](https://www.ok-t.ru/studopediaru/baza17/2045932067236.files/image111.jpg)

# Метод Ньютона

Если предыдущий метод сводился к построению хорд, то этот метод сводится к построению касательных. Поэтому этот метод называют еще `метод касательных`. 

В данном методе у нас есть начальная точка, заданная произвольно, — $x_0$. Пусть производная первого порядка от $x$ — $y(x)$, а второго порядка — $y^2(x)$. Мы определяем новую точку касания графика производной функции: 
$x_n = x_k - y(x_k)/y^2(x_k)$, где $n = k+1$. То есть мы на графике определяем новую точку касания и проводим через нее касательную. На графике новая точка касания — это $x$, в котором последняя касательная пересекает ось горизонтальную.

![](https://otvet.imgsmail.ru/download/u_43635d865fc11937190566e24cfcf637_800.jpg)

# Метод квадратичной аппроксимации

Это, наверное, самый муторный по количеству шагов метод. 

Суть в том, что у нас есть график функции. 
1. $x_0$ — произвольно заданная функция.
2. $x_1 = x_0 + del$, где del — произвольно заданный шаг. Это вторая точка.
3. Находим значения функции в этих точках.
4. Если $f(x_1)<=f(x_2) -> x_3 = x_1 - del$, иначе $x_3 = x_1 + 2*del$.
5. Находим значение функции в третьей точке.
6. Находим среди значений функции минимум $F_m$ и соответствующий минимальный $x_m$. То есть наш на графике одну и трех точек, значений функции которой наименьший.
7. Через эти три точки провдим квадратичный интерполяционный полином. И находим у него минимум по формуле
   ![](https://github.com/roge111/Optimization-methods/blob/main/Формула%20квадратичного%20полинома.jpg?raw=true)

   Если знаменатель равен нулю, то $x_1 = x_m$ и переходиму к шагу 2
8. Условия остановки:
   ![](https://github.com/roge111/Optimization-methods/blob/main/Условия%20остановки.jpg?raw=true)

   Если одно из них не выполняется то делаем так:

   Выбираем наименьшую точку из $x_m$ или $x_p$, где $x_p$ - это минимум квадратичного интерполяционного полинома. Делаем мы это, если при отсортированных $x_1,x_2,x_3$ $x_p$ находится в их отрезке от $x_1$ до $x_3$. После определения наименьшей точки мы выбираем две точки: по одной с каждой стороны от выбранной точки. Выбираем уже из тех, что имеем. И переходим к шагу 6. Если $x_p$ не попадает в отрезок трех точек, то $x_1 = x_p$ и переходим к шагу 2


     
![](https://github.com/roge111/Optimization-methods/blob/main/Графике%20метода%20кв.jpg?raw=true)
